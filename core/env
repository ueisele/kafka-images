#!/usr/bin/env bash

function kafka_server_image_name () {
    local user=${1:?"Missing Docker registry user as first parameter!"}
    local git_repo=${2:?"Missing Git repo as second parameter!"}
    echo "${user}/${git_repo//\//-}-server"
}

function kafka_server_image_tags () {
    local kafka_version=${1:?"Missing Kafka version as first parameter!"}
    local kafka_git_commit_sha=${2:?"Missing Kafka Git sha as second parameter!"}
    local base_image_tags="${@:3}"
    local kafka_server_full_image_tag="${kafka_version//-g${kafka_git_commit_sha}/}-g${kafka_git_commit_sha}"
    local kafka_server_short_image_tag="${kafka_version}"
    echo $(kafka_server_combine_tags ${kafka_server_full_image_tag} ${base_image_tags}) $(kafka_server_combine_tags ${kafka_server_short_image_tag} ${base_image_tags}) ${kafka_server_full_image_tag} ${kafka_server_short_image_tag}
}

function kafka_server_combine_tags () {
    local tag=${1:?"Missing tag to prepend as first parameter!"}
    local array="${@:2}"
    for e in ${array}; do
        printf "${tag}-${e} "
    done
}